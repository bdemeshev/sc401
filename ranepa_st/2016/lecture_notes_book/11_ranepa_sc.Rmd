# Условное математическое ожидание {#expected_value_masha}

Конспект: Максимов Иван

дата: 14 октября 2016

## Машенька и грибы (8.51 из [задачника](https://github.com/bdemeshev/sc401/raw/master/sc_pset/sc_problems_main.pdf))

![](http://mycoweb.ru/Submitted/AWP/Korsina_AWP_20131011.jpg)



### Условия задачи:

Маша пошла в лес собирать грибы. Она собрала $n$ грибов. Ей могли попасться рыжики с вероятностью $r>0$, лисички с вероятностью $l>0$ или мухоморы с вероятностью $m>0$. Обозначим количество собранных рыжиков, лисичек и мухоморов за $R, L, M$, соответственно.

### Найти:

1) $E(R + L|M)$

2) $E(M|R + L)$

3) $E(R|L)$

4) $Var(R|L)$

5) $E(R + M|L + M)$

6) $P(E(R|L) = 0)$

7) $P(R = 0|L)$

8) $E((\dfrac{m}{r + m})^{100 - L})$

### Решение:

1) Очевидно, что $R + L + M = n \Rightarrow R + L = n - M$, тогда при известном $M$ величина $R + L$ известна и не случайна $\Rightarrow$ 
\[
E(R + L|M) = E(R + L|R + L) = R + L = n - M
\]

2) Аналогично, зная $R + L$, можно определить $M = n - R - L$ $\Rightarrow$ 
\[
E(M|R + L) = E(M|M) = M = n - R - L
\]

3) Для решения этого пункта рассмотрим для начала частный случай. Пусть $L = 40, n = 100$. Найдем $E(R|L = 40)$
Так как лисичек 40, то оставшихся грибов $100 - 40 = 60$, так как $R + M = n - L$. Среди $60$ оставшихся грибов может быть $0, 1, 2, ..., 60$ рыжиков. Найдем, например, $P(R = 0|L = 40)$, то есть вероятность того, что среди оставшихся $60$ грибов будет $0$ рыжиков. Заметим, что число собранных лисичек распределено биномиально, так как найденную лисичку можно рассматривать, как "успех", а найденную не лисичку — как "не успех".
\[
L \sim Bin(n = 100, p = l) \Rightarrow
\]
\[
P(R = 0|L = 40) = \dfrac{P(R = 0; L = 40)}{P(L = 40)} = \dfrac{(C^{40}_{100}l^{40})(С^{60}_{60}m^{60})}{C^{40}_{100}l^{40}l^{100-40}}
\]

Поясним числитель дроби: из 100 грибов выбираются 40 лисичек, а из оставшихся 60 грибов — 40 мухоморов.

Найдем $P(R = 3|L = 40)$:
\[
P(R = 3|L = 40) = \dfrac{P(R = 3; L = 40)}{P(L = 40)} = \dfrac{P(R = 3;L = 40;M = 47)}{P(L = 40)} = \dfrac{(C^{40}_{100}l^{40})(C^{3}_{60}r^{3})(С^{57}_{47}m^{57})}{C^{40}_{100}l^{40}l^{100-40}} = C^{3}_{60}(\dfrac{r}{r+m})^3(\dfrac{m}{r+m})^{47}
\]
Можно заметить, что $R|L = 40 \sim Bin(n = 60; p = \dfrac{r}{r + m}) \Rightarrow R|L\sim Bin(n = n - L; p = \dfrac{r}{r + m}) \Rightarrow$ по формуле математического ожидания биномиального распределения:

\[
E(R|L) = (n - L)\dfrac{r}{r + m}
\]

4) По формуле для дисперсии биномиального распределения с учетом того, что 
$L|L + M\sim Bin(n = L + M; p = \dfrac{l}{l + m})$:
\[
var(R|L) = (n - L)\dfrac{r}{r + m}\dfrac{m}{r + m}
\]

5) По аналогии с предыдущим пунктом, используя свойство условного мат.ожидания(мат. ожидание суммы=суммы мат.ожиданий), получим: 
\[
E(R + L|L + M) = E(R|L + M) + E(L|L + M) = n - L - M + (L + M)\dfrac{l}{l + m}
\]

6) С учётом того, что мы в пункте №3 уже посчитали $E(R|L)$, получаем:

\[
P(E(R|L) = 0) = P((n - L)\dfrac{r}{r + m} = 0) \Leftrightarrow P(L = n) = l^{100}
\]

7) Учитывая, что $M|L\sim Bin(n = n - L, p = \dfrac{m}{r + m})$, получим:
\[
P(R = 0|L) = P(M = n - L|L) = (\dfrac{m}{r + m})^{n - L}
\]

8) Заметим, что $(\dfrac{m}{r + m})^{100 - L} = P(R = 0|L)$. С учётом этого: 
\[
E((\dfrac{m}{r + m})^{100 - L}) = E(P(R = 0|L)) = (1 - r)^{100} = (l + m)^{100}
\]

Доказательство законности первого равенства в п.8 смотрите в задаче № 11.2.

### Закон повторного мат.ожидания действует и с вероятностью!
Известно, что выполняется равенство: $E(E(X|Y))=E(X)$

**Утверждаю, что верно и следующее:** $E(P(A|Y))=P(A).$

*Доказательство:*
Вероятность можно трактовать как математическое ожидание: пусть событие $A =  \{$ Мила выйдет на улицу и увидит котёнка $\}$, тогда
$I_A = 1$, если событие $A$ — наступило и $I_A = 0$, если событие $A$ — не наступило. Тогда $$E(I_A) = P(A)$$
Если $X = I_A$, то:

\[
E(E(X|Y)) = E(Y) \Leftrightarrow E(P(A|Y)) = E(I_A)=P(A)
\]

### Неожиданный факт про условное математическое ожидание:

Так как агент, который знает $R$ однозначно может посчитать $R^3$, то можно делать так:
\[
E(L|R) = E(L|R^3)
\]
Но агент, который знает $R^2 - 3$ не может однозначно посчитать $R$, то есть он не отличает события $R = 1$ и 
$R = 4 \Rightarrow$
\[
E(L|R)\neq E(L|(R - 3)^2)
\]

### Если возникли проблемы
Если у вас что-то не получается с условным математическим ожиданием и дисперсией, то предлагаю посмотреть короткие [видеолекции](https://www.coursera.org/learn/ekonometrika/lecture/ATG3O/2-1-1-uslovnoie-matiematichieskoie-ozhidaniie-opriedielieniie) от Бориса Борисовича по данной теме. Это лекции 2.1.1 — 2.1.4 в курсе [Эконометрика](https://www.coursera.org/learn/ekonometrika) на Coursera. Не забудьте предварительно зарегистрироваться на курс :)

