#  Мартингалы {#martingales_define}

Конспект: Маслова Инна

дата: 14 ноября 2016

## Определение мартингала
### Необходимые сведения перед основным определением
* Определение 1: Случайный процесс в дискретном времени - это последовательность случайных величин $x_1,x_2,x_3,\ldots$
Формальная запись: ($x_n$).
* Определение 2: Фильтрация (поток $\sigma$-алгебр) - последовательность $\sigma$-алгебр $\mathcal{F_1}$,$\mathcal{F_2}$,$\mathcal{F_3}$,$\ldots$ такая, что для любого $n$ $\mathcal{F}_n\subseteq \mathcal{F_{n+1}}$ (последующая $\sigma$-алгебра содержит предыдущую).
* Определение 3: фильтрация $\mathcal{F}_n$ называется естественной фильтрацией для процесса ($x_n$), если все, что я знаю - значение $x$, то есть для любого $n$: $\mathcal{F}_n=\sigma(x_1,x_2,\ldots,x_n)$ ( то есть в 1 день я знаю, что было в $x_1$,во 2 день- что было в $x_1$ и $x_2$ и так далее).

### Определение мартингала
Процесс ($x_n$) называется мартингалом по отношению к фильтрации $\mathcal{F}_n$, если выполнены 2 условия:

1) для любого $n$  $x_n$ измерима относительно $\mathcal{F}_n$ (мне хватает $\mathcal{F}_n$ чтобы сказать, чему равно $x_n$) $\newcommand{\Expect}{\mathsf{E}}$

2) $\Expect (x_{n+1}|\mathcal{F}_n)=x_n$

Мартингал - процесс, который в среднем не меняется.

## Задачи
### Постановка задачи
Является ли процесс ($x_n$) мартингалом по отношению к фильтрации $\mathcal{F}_n$?

a) $z_1,z_2,\ldots,z_n$ - независимы и $z_i\sim N(0,49)$, $x_n=\sum_{i=1}^n z_i$. Фильтрация: $\mathcal{F}_n=\sigma(z_1,z_2,\ldots,z_n)$

b) $z_1,z_2,\ldots,z_n$ - независимы и $z_i\sim U[0,1]$, $x_n=\sum_{i=1}^n z_i$. Фильтрация: $\mathcal{F}_n=\sigma(z_1,z_2,\ldots,z_n)$

c) Есть колода карт. Всего 52 карты, 4 масти.Я открываю одну карту за другой и смотрю, какую карту я открыла. Пусть $x_n$ - доля тузов в оставшейся колоде после открытия $n$ карт.$\mathcal{F}_n$ - знаю те карты, которые открыты. Рассмотрим, какие значения могут принимать $x_0$ и $x_{51}$.

$x_0=\dfrac4{52}$ 

После открытия 51 карты, получим, что значения, которые принимает $x_{51}$ будет либо 1 (последняя карта - туз), либо 0 (последняя карта - не туз). Тогда вероятность того, что последняя карта окажется тузом, равна $\dfrac4{52}$, так как всего 4 туза, а количество карт равно 52.

|   исход  |     не туз     |     туз     |
|----------|----------------|-------------|
| $x_{51}$ |       $0$      |     $1$     |
|   $p$    |$\dfrac{48}{52}$|$\dfrac4{52}$|

d) Сколько элементов в $\mathcal{F_1}$ и $\mathcal{F_2}$? Понять, что больше, число элементарных частиц во Вселенной или число элементов в $\mathcal{F_2}$?

### Решение
Для всех случаев нужно проверить выполнение 2 условий из определения мартингала.

**a) Рассмотрим 1 случай**

   1 условие: Я знаю $z_1,z_2,\ldots,z_n$ и так как $x_n=\sum_{i=1}^n z_i$, то я знаю $x_n$.

   2 условие: $\Expect (x_{n+1}|\mathcal{F}_n)=\Expect (z_1+z_2+\ldots+z_{n+1}|z_1,z_2,\ldots,z_n)$=(знаю $z_1,z_2,\ldots,z_n$, поэтому могу их вынести)=$z_1+z_2+\ldots+z_n+\Expect (z_{n+1}|z_1,z_2,\ldots,z_n)$=
   
=$z_1+z_2+\ldots+z_n+\Expect (z_{n+1})=z_1+z_2+\ldots+z_n=x_n$
 
 Пояснения к вычислениям ко 2 условию: ($\Expect (z_{n+1})=0$ так как $z_i=N(0,1)$
 
 $\Expect (z_{n+1}|z_1,z_2,\ldots,z_n)=\Expect (z_{n+1})$, так как случайные величины $z_1,z_2,\ldots,z_{n+1}$ независимы) 
 
 Оба условия выполняются, значит, процесс ($x_n$) мартингал по отношению к фильтрации $\mathcal{F}_n$.

**b) Рассмотрим 2 случай**

   1 условие: Я знаю $z_1,z_2,\ldots,z_n$ и так как $x_n=\sum_{i=1}^n z_i$, то я знаю $x_n$.

   2 условие: $\Expect (x_{n+1}|\mathcal{F}_n)=\Expect (z_1+z_2+\ldots+z_{n+1}|z_1,z_2,\ldots,z_n)$=(знаю $z_1,z_2,\ldots,z_n$, поэтому могу их вынести)=$z_1+z_2+\ldots+z_n+\Expect (z_{n+1}|z_1,z_2,\ldots,z_n)=z_1+z_2+\ldots+z_n+\Expect (z_{n+1})$=
   
=$z_1+z_2+\ldots+z_n+\dfrac{0+1}{2}=x_n+\dfrac12 \ne x_n$ 

2 условие не выполняется, значит, в этом случае процесс ($x_n$) не является мартингалом.

**c) Рассмотрим 3 случай**

   1 условие: выполнено, так как если я вижу открытые карты, то могу посчитать долю тузов среди неоткрытых, то есть могу посчитать $x_n$
   
   2 условие:
 Спрогнозируем долю тузов, когда открою следующую карту : $\Expect (x_{n+1}|\mathcal{F}_n)$
 
 Сейчас: открыто $n$, закрыто 52-$n$
         
 Доля тузов среди закрытых карт: $x_n$
 
 Количество закрытых тузов: $x_n(52-n)$
 
 Тогда вероятность того, что при открытии $n+1$ карты будет туз равна доле тузов среди закрытых карт или $x_n$. Если карта - туз, то после её открытия доля тузов будет равна $x_{n+1}=\dfrac{(52-n)x_n-1}{51-n}$. Если же при открытии карта окажется не тузом, то $x_{n+1}=\dfrac{(52-n)x_n}{51-n}$. Ниже представлена таблица с долями тузов и вероятностями исходов.
 
|  Исход  |           туз             |         не туз          |
|---------|---------------------------|-------------------------|
|$x_{n+1}$|$\dfrac{(52-n)x_n-1}{51-n}$|$\dfrac{(52-n)x_n}{51-n}$|
|   $p$   |            $x_n$          |          $1-x_n$        |
 
  
  

$\Expect (x_{n+1}|\mathcal{F}_n)=x_n\dfrac{(52-n)x_n-1}{51-n}+(1-x_n)\dfrac{(52-n)x_n}{51-n}$=

=$\dfrac{52x_n^2-nx_n^2-x_n+52x_n-52x_n^2-nx_n+nx_n^2}{51-n}=\dfrac{51x_n-nx_n}{51-n}=x_n$ 

2 условие выполняется.

Оба условия выполняются, значит, процесс ($x_n$) мартингал по отношению к фильтрации $\mathcal{F}_n$.

**d) Последнее задание**

$\mathcal{F_1}$ содержит 52 элементарных события (например, карта №1 - крести, карта №2 - туз пик и т.д.). Каждое событие либо включаем либо не включаем, поэтому получим $card\mathcal{F_1}=2^{52}$

$card\mathcal{F_2}=2^{C_{52}^1C_{51}^1}=2^{52*51}\approx(4*10^{15})^{51}=4^{51}*10^{15*51}$ 

Число элементарных частиц во Вселенной $10^{81}$

$4^{51}*10^{15*51}\gg 10^{81}$

## Зачем изучать мартингалы?
В реальности случайные процессы - не мартингалы. Можно сделать из процесса мартингал, изучить его (все просто считается), сделать какие-то выводы, а затем, используя эти выводы, изучить исходный процесс.

**Упражнение**

$z_1,z_2,\ldots,z_n$ - независимы и $z_i\sim U[0,1]$, $x_n=\sum_{i=1}^n z_i$. Фильтрация: $\mathcal{F}_n=\sigma(x_1,x_2,\ldots,x_n)$. Возьмем процесс $M_n=a^{x_n}$. Нужно подобрать число $a$ так, чтобы $(M_n)$ был мартингалом относительно фильтрации $\mathcal{F}_n$.

**Решение**

Простой случай: $a=1$. Действительно, $(M_n)=(1,1,1,1,\ldots)$. Тогда $\Expect (M_{n+1}|\mathcal{F}_n)=1=M_n$, а значит, $(M_n)$ - мартингал. 

Теперь попробуем найти $a \ne 1$. Для этого проверим выполнимость двух условий из определения мартингала.

1 условие: $M_n$ измерим относительно $\mathcal{F}_n$ при известном $a$

2 условие: $\Expect (M_{n+1}|\mathcal{F}_n)=\Expect (a^{x_{n+1}}|\mathcal{F}_n)=\Expect (a^{z_1+z_2+\ldots+z_{n+1}}|\mathcal{F}_n)$=(знаю $z_1,z_2,\ldots,z_n$, поэтому могу их вынести)=$a^{z_1+z_2+\ldots+z_n}\Expect (a^{z_{n+1}}|\mathcal{F}_n)=a^{x_n}\Expect (a^{z_{n+1}}|\mathcal{F}_n)$=(так как случайная величина $z_{n+1}$ не зависит от $z_1,z_2,\ldots,z_n$) =$M_n\Expect (a^{z_{n+1}})$=(должно быть равно по определению мартингала)=$M_n$.Тогда

$\Expect (a^{z_{n+1}})=1$

$\Expect (a^{z_{n+1}})=\int\limits_0^1 a^t\,dt=1$

$\int\limits_0^1 e^{t*\ln a}\,dt=\left. \dfrac{e^{t*\ln a}}{\ln a}\right|_0^1=\dfrac{e^{\ln a}}{\ln a}-\dfrac1{\ln a}=\dfrac{e^{\ln a}-1}{\ln a}=\dfrac{a-1}{\ln a}=1$ => 

=> $a-1=\ln a$

Это уравнение имеет единственное решение $a=1$

Получаем:Процесс $M_n=a^{x_n}$ является мартингалом относительно фильтрации $\mathcal{F}_n$ только при $a=1$









